## Введение в `journalctl`

`journalctl` — это мощная команда для просмотра и фильтрации системных журналов в Linux. Она работает с `systemd-journald` — системой сбора и хранения логов, которая управляется `systemd`.

### Базовые действия с `journalctl`

Прежде всего, давайте посмотрим, как использовать эту утилиту. Откройте терминал и введите:

```bash
journalctl
```

Эта команда покажет вам **все** системные журналы, которые отсортированы в хронологическом порядке. Если вы ожидаете увидеть что-то скромное, то приготовьтесь: обычно логи занимают несколько экранов. Не пугайтесь, мы научимся их фильтровать чуть позже.

Теперь, чтобы выйти из просмотра логов, нажмите **`q`** (вы ведь уже успели оценить схожесть `less` и `journalctl`?).

---

### Фильтрация логов по времени

Сейчас будем магически сузить логи до более удобного диапазона.

**Просмотр логов за последний час**

```bash
journalctl --since "1 hour ago"
```

**Просмотр логов за конкретный день**

```bash
journalctl --since "2023-10-31"
```

**Указание временного диапазона**

Хотите посмотреть события с 8 утра до 9 утра? Нет проблем:

```bash
journalctl --since "2023-10-31 08:00:00" --until "2023-10-31 09:00:00"
```

Фильтрация по времени полезна, например, если вы знаете, что проблема началась в определённый момент. Аналогия: вы не читаете всю книгу, чтобы понять, кто убийца — вы просто смотрите последние страницы.

---

### Работа с логами конкретного сервиса

Вместо того чтобы разбираться во всей системе, вы можете сфокусироваться на одном сервисе. Например, хотите посмотреть, как работает веб-сервер `nginx`:

```bash
journalctl -u nginx
```

Если хотите видеть записи только за последний час (а все мы любим свежие куски информации):

```bash
journalctl -u nginx --since "1 hour ago"
```

**Краткий список примеров:**

- `-u ssh`: Логи для сервиса SSH.
- `-u cron`: Логи задач CRON.
- `-u mysql`: Логи базы данных MySQL.

---

### Чтение логов в реальном времени

Когда вы чините что-то прямо сейчас, может быть полезно наблюдать за логами в режиме реального времени — как за футбольным матчем. Для этого используйте команду:

```bash
journalctl -f
```

Опция `-f` работает аналогично `tail -f`, показывая новые записи логов по мере их появления.

К примеру, попробуйте запустить команду и параллельно перезапустить какой-нибудь сервис:

```bash
sudo systemctl restart ssh
```

Вы увидите изменения — запись о перезапуске появится в логах.

---

### Поиск ошибок в логах

Часто логи бывают длинными, и искать там интересующую информацию вручную почти как искать иголку в стоге сена. Поэтому можно использовать поиск по ключевым словам.

**Простое использование:**

```bash
journalctl | grep "ERROR"
```

Этот пример покажет только те строки, которые содержат слово `ERROR`. Вы можете заменить `ERROR` на что угодно, например `WARNING`, `failed` или `panic`.


## Особые опции для `journalctl`

### Просмотр записей только после перезагрузки

Хотите узнать, что происходило после последнего запуска системы? Загадочно? Просто сделайте:

```bash
journalctl -b
```

Каждая перезагрузка системы фиксируется как отдельный "блок". Если вы хотите посмотреть записи после предпоследней загрузки (да-да, такое бывает полезно):

```bash
journalctl -b -1
```

### Фильтрация по пользователю или PID

Иногда нужно отследить действия конкретного пользователя или процесса. Например:

```bash
journalctl _UID=1000
```

Замените `1000` на ID пользователя (узнать ID можно с помощью команды `id`).

Для фильтрации по PID (идентификатору процесса):

```bash
journalctl _PID=1234
```