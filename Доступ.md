Каждый файл (и директория) в Linux имеет три набора прав доступа, которые определяют, кто может их читать, записывать или выполнять:

1. **Чтение (r):** Позволяет просматривать содержимое файла или список файлов в директории.
2. **Запись (w):** Разрешает изменять содержимое файла или добавлять/удалять файлы из директории.
3. **Выполнение (x):** Даёт возможность выполнять файл как программу (или заходить в директорию).

### Трёхуровневая модель
![[Pasted image 20251016033427.png]]
Каждое право применяется к трём группам пользователей:

- **Владелец (owner):** Тот, кто создал файл.
- **Группа (group):** Пользователи, объединенные в группу, которой назначен файл.
- **Остальные (others):** Все остальные пользователи системы.

Пример прав доступа для файла:

```text
-rwxr-xr--
```

Расшифруем:

- Первый символ `-` обозначает, что это файл (для директории будет `d`).
- Первые три символа `rwx` — права для владельца (чтение, запись, выполнение).
- Следующие три символа `r-x` — права для группы (чтение, выполнение).
- Последние три символа `r--` — права для остальных (только чтение).

## Команда `chmod`: управление правами доступа

### Символьный формат записи

Команда `chmod` изменяет права доступа к файлам и директориям. Символьный формат записи выглядит так:

```text
chmod [кто][действие][права] имя_файла
```

- **Кто:** `u` (владелец), `g` (группа), `o` (остальные), `a` (все).
- **Действие:** `+` (добавить права), `-` (убрать права), `=` (установить права точно).
- **Права:** `r` (чтение), `w` (запись), `x` (выполнение).

Примеры:

```text
# Установим права на выполнение для всех
chmod a+x script.sh

# Добавим возможность записи только для группы
chmod g+w file.txt

# Заберем право чтения у остальных
chmod o-r document.txt
```

### Восьмеричный формат записи

![](https://cdn.javarush.com/images/article/865bbbe7-b0d9-441f-8feb-da7613bcc8aa/800.webp)

Восьмеричный формат (или числовой) более компактный, но требует понимания "магии чисел". В этом формате каждая комбинация прав представляется числом:

- `r = 4`
- `w = 2`
- `x = 1`

Права складываются:

- `rwx = 7` (4 + 2 + 1)
- `rw- = 6` (4 + 2)
- `r-- = 4`

Формат записи:

```text
chmod [число][число][число] имя_файла
```

Пример:

```text
# Установим права rwx для владельца, r-x для группы, r-- для остальных
chmod 754 file.sh
```

## Изменение владельца файла: команда `chown`

Если вам нужно передать файл другому пользователю (или группе), поможет команда `chown`.

Формат:

```text
chown [пользователь]:[группа] имя_файла
```

Примеры:

```text
# Передача владения пользователю user1
chown user1 myfile.txt

# Передача владельца и группы
chown user1:group1 myfile.txt

# Только смена группы
chown :group2 myfile.txt
```

## Маска по умолчанию: `umask`

Когда вы создаете файл, права доступа для него определяются системой. Например, права могут быть `rw-r--r--`. Но откуда они берутся? Ответ: от команды `umask`.

### Что такое `umask`?

`umask` определяет, какие права **не будут установлены** для новых файлов.

Например:

- Базовый набор прав для файла: `666` (нет выполнения).
- Маска: `022`.
- Итоговые права: `644` (`666 - 022`).

Команды:

- Посмотреть текущую маску: `umask`
- Установить новую маску: `umask 0022`

Пример:

```text
# Установка маски, чтобы новые файлы имели rw-rw-r--
umask 0002
```

### **Как работает `sudo`?**

**Запуск команды:**

Когда вы вводите команду с `sudo`, система проверяет, есть ли у вашего пользователя право выполнять команды с повышенными привилегиями.

Например:

```bash
sudo apt update
```

**Аутентификация:**

При первом использовании `sudo` в текущей сессии система попросит ввести пароль текущего пользователя (не root).

После успешного ввода пароля система сохраняет аутентификацию на короткий промежуток времени (обычно 5-15 минут), чтобы не запрашивать пароль для каждой команды.

**Выполнение команды:**

Если пользователь имеет права, указанные в конфигурации `sudo`, команда будет выполнена с правами суперпользователя.

### **Основные функции и команды `sudo`**

**Запуск команды с привилегиями:**

```bash
sudo <команда>
```

Например:

```bash
sudo apt install nginx
```

**Выполнение команды от имени другого пользователя:** Используйте флаг `-u`:

```bash
sudo -u <имя_пользователя> <команда>
```

Например:

```bash
sudo -u user1 ls /home/user1
```

**Получение административного терминала:** Запустите оболочку с правами root:

```bash
sudo -i
```

или:

```bash
sudo su
```

**Просмотр конфигурации `sudo`:**

```bash
sudo -l
```

Показывает команды, которые текущий пользователь имеет право выполнять.

**Редактирование конфигурации `sudo`:**

```bash
sudo visudo
```

Эта команда открывает файл конфигурации `/etc/sudoers` для безопасного редактирования.